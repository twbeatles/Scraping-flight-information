# ✈️ Flight Bot v2.4 - Pro
**Playwright 기반 실시간 항공권 최저가 검색 및 분석 솔루션**

Flight Bot은 인터파크 투어의 실시간 데이터를 기반으로 최저가 항공권을 자동으로 검색, 수집, 분석하는 파이썬 데스크톱 애플리케이션입니다. 강력한 브라우저 자동화 엔진(Playwright)을 탑재하여 복잡한 동적 웹사이트에서도 안정적으로 데이터를 수집하며, 사용자 친화적인 GUI를 통해 쉽고 빠르게 항공권을 비교할 수 있습니다.

---

## ✨ v2.4 주요 업데이트
- **🎨 테마 변경**: 눈이 편안한 **다크 모드**와 가독성이 뛰어난 **라이트 모드**를 지원합니다.
- **🇰🇷 국내선 알고리즘 강화**: 국내선 왕복 검색 시 다양한 시간대의 오는편 조합을 제공합니다. (시간 필터 개선 포함)
- **⚙️ UX 리팩토링**: 버튼 글로우 효과, 최저가 하이라이트, 상세 툴팁, 단축키 지원 등 사용자 경험이 대폭 향상되었습니다.

---

## 🚀 주요 기능

### 1. 강력한 검색 엔진
- **국내선/국제선 완벽 지원**: 편도 및 왕복 항공권 검색
- **정밀한 자동 스크롤**: 최대 300회의 스마트 스크롤링으로 숨겨진 항공권까지 놓치지 않고 수집
- **수동 개입 모드**: 자동화 탐지나 캡차(CAPTCHA) 발생 시 사용자가 직접 개입하여 검색 재개 가능
- **다중 목적지 검색**: 여러 도시를 한 번에 검색하여 최저가 비교 (예: 도쿄/오사카/후쿠오카 동시 검색)

### 2. 스마트 필터 및 정렬
- **시간대 필터**: 출발/도착 시간 범위를 1시간 단위로 세밀하게 조정 (24시 포함 로직 개선)
- **항공사 필터**: LCC(저비용항공사)와 FSC(일반항공사) 구분 필터링
- **경유 횟수**: 직항/경유 및 최대 경유 횟수 설정
- **실시간 정렬**: 최저가순, 최단시간순, 출발/도착 시간순 즉시 정렬

### 3. 데이터 분석 및 저장
- **결과 내보내기**: 검색 결과를 Excel(.xlsx) 또는 CSV 파일로 저장
- **최저가 하이라이트**: 검색 결과 중 가장 저렴한 항공편을 자동으로 강조 표시
- **날짜별 검색**: 지정한 기간(예: 7월 1일 ~ 7월 31일) 동안의 최저가 추이 분석

---

## 🛠️ 설치 및 실행 방법

### 사전 요구 사항
- **Python 3.8 이상**이 설치되어 있어야 합니다.
- Chrome 또는 Edge 브라우저가 설치되어 있어야 합니다.

### 1단계: 패키지 설치
프로젝트 폴더에서 터미널을 열고 필요한 라이브러리를 설치합니다.
```bash
pip install playwright PyQt6 pandas openpyxl
```

### 2단계: 브라우저 엔진 설치
Playwright가 사용할 브라우저 바이너리를 설치합니다.
```bash
playwright install chromium
```

### 3단계: 프로그램 실행
```bash
python gui_v2.py
```

---

## 📖 사용 가이드

### 1. 기본 검색
1. **노선 선택**: 국내선 또는 국제선을 선택합니다.
2. **출발지/도착지**: 공항 코드를 입력하거나 선택합니다 (예: ICN, NRT).
3. **날짜 선택**: 달력을 클릭하여 가는 날과 오는 날을 선택합니다.
4. **검색 시작**: `🔍 최저가 항공권 검색하기` 버튼을 누르거나 `Ctrl+Enter`를 입력합니다.

### 2. 검색 결과 활용
- **정렬**: 테이블 헤더(가격, 출발시간 등)를 클릭하여 정렬합니다. 가장 저렴한 항공권은 초록색으로 강조됩니다.
- **예약**: 원하는 항공권 행을 **더블 클릭**하면 인터파크 예약 페이지가 열립니다.
- **즐겨찾기**: 마우스 우클릭 후 "⭐️ 즐겨찾기에 추가"를 선택하여 저장할 수 있습니다.

### 3. 단축키 (Shortcuts)
- **`Ctrl + Enter`**: 검색 시작
- **`Esc`**: 검색 중단 또는 닫기
- **`Ctrl + S`**: 현재 검색 조건(프로필) 저장
- **`Ctrl + E`**: 결과를 Excel로 내보내기

### 4. 테마 변경
- 프로그램 우측 상단의 `🌙 다크` / `☀️ 라이트` 버튼을 클릭하여 테마를 전환할 수 있습니다.

---

## ⚠️ 주의사항 및 문제 해결
- **스크래핑 속도**: 웹사이트의 응답 속도에 따라 검색 시간이 달라질 수 있습니다.
- **데이터 없음**: "데이터를 찾을 수 없습니다" 메시지가 뜨면 "수동 모드"로 전환하여 직접 검색 결과를 띄운 후 추출을 시도하세요.
- **휠 오작동 방지**: 필터 영역의 숫자 입력 칸은 마우스 휠로 값이 변경되지 않도록 설정되어 있어, 오입력을 방지합니다.

---

## 📦 배포 (Build)
PyInstaller를 사용하여 실행 파일(.exe)로 만들 수 있습니다.
```bash
pyinstaller flight_bot.spec
```
빌드가 완료되면 `dist/FlightBot_v2.4` 폴더 내의 실행 파일을 사용하세요.

---
**Disclaimer**: 이 프로그램은 개인적인 학습 및 연구 목적으로 제작되었습니다. 수집된 데이터를 상업적으로 무단 사용 시 법적 책임이 따를 수 있습니다.
